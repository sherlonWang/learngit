amao's work on dev branch.
fix a bug
